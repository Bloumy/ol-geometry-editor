!function(t){var e={};function i(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(o,n,function(e){return t[e]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=7)}([function(t,e){t.exports={tileLayers:[{title:"Openstreet Map",url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'©<a href="http://openstreetmap.org">OpenStreetMap contributors</a>'}],tileLayerSwitcher:!1,switchableLayers:[],tileCoordinates:[9,253,-177],defaultSwitchableTile:1,hide:!0,editable:!0,width:"100%",height:"500",lon:2,lat:45,zoom:4,minZoom:4,maxZoom:19,geometryType:"Geometry",centerOnResults:!0,precision:7}},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAC5ElEQVRYw+2YW4/TMBCF45S0S1luXZCABy5CgLQgwf//S4BYBLTdJLax0fFqmB07nnQfEGqkIydpVH85M+NLjPe++dcPc4Q8Qh4hj5D/AaQJx6H/4TMwB0PeBNwU7EGQAmAtsNfAzoZkgIa0ZgLMa4Aj6CxIAsjhjOCoL5z7Glg1JAOkaicgvQBXuncwJAWjksLtBTWZe04CnYRktUGdilALppZBOgHGZcBzL6OClABvMSVIzyBjazOgrvACf1ydC5mguqAVg6RhdkSWQFj2uxfaq/BrIZOLEWgZdALIDvcMcZLD8ZbLC9de4yR1sYMi4G20S4Q/PWeJYxTOZn5zJXANZHIxAd4JWhPIloTJZhzMQduM89WQ3MUVAE/RnhAXpTycqys3NZALOBbB7kFrgLesQl2h45Fcj8L1tTSohUwuxhy8H/Qg6K7gIs+3kkaigQCOcyEXCHN07wyQazhrmIulvKMQAwMcmLNqyCVyMAI+BuxSMeTk3OPikLY2J1uE+VHQk6ANrhds+tNARqBeaGc72cK550FP4WhXmFmcMGhTwAR1ifOe3EvPqIegFmF+C8gVy0OfAaWQPMR7gF1OQKqGoBjq90HPMP01BUjPOqGFksC4emE48tWQAH0YmvOgF3DST6xieJgHAWxPAHMuNhrImIdvoNOKNWIOcE+UXE0pYAnkX6uhWsgVXDxHdTfCmrEEmMB2zMFimLVOtiiajxiGWrbU52EeCdyOwPEQD8LqyPH9Ti2kgYMf4OhSKB7qYILbBv3CuVTJ11Y80oaseiMWOONc/Y7kJYe0xL2f0BaiFTxknHO5HaMGMublKwxFGzYdWsBF174H/QDknhTHmHHN39iWFnkZx8lPyM8WHfYELmlLKtgWNmFNzQcC1b47gJ4hL19i7o65dhH0Negbca8vONZoP7doIeOC9zXm8RjuL0Gf4d4OYaU5ljo3GYiqzrWQHfJxA6ALhDpVKv9qYeZA8eM3EhfPSCmpuD0AAAAASUVORK5CYII="},function(t,e){t.exports="data:image/png;base64,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"},function(t,e,i){var o=i(21);t.exports=function(t,e){return"Rectangle"===e?JSON.stringify(o(t)):JSON.stringify(t)}},function(t,e,i){var o=i(5);t.exports=function(t,e){var i=(new ol.format.GeoJSON).writeFeatures(t.getArray(),{featureProjection:e.mapProjection,dataProjection:e.dataProjection,decimals:e.precision});return o(JSON.parse(i))}},function(t,e,i){var o=i(23);t.exports=function(t){var e=[];return t.features.forEach(function(t){e.push(t.geometry)}),0===e.length?null:e.length>=1?o(e):void 0}},function(t,e){t.exports=function(t){switch(t.type){case"Point":case"LineString":case"Polygon":return[t];case"MultiPoint":case"MultiLineString":case"MultiPolygon":return function(t){var e=[],i=t.type.substring("Multi".length);return t.coordinates.forEach(function(t){e.push({type:i,coordinates:t})}),e}(t);case"GeometryCollection":return function(t){var e=[];return t.geometries.forEach(function(t){e.push(t)}),e}(t);default:throw"unsupported geometry type : "+t.type}}},function(t,e,i){(function(e){i(36),i(44),i(46),e.ge={defaultParams:i(0),GeometryEditor:i(9)},jQuery&&(jQuery.fn.geometryEditor=function(t){return this.each(function(){var i=new e.ge.GeometryEditor(this,t);$(this).data("editor",i)})}),t.exports=e.ge}).call(this,i(8))},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){var o=i(0),n=i(10),r=function(t,e){this.settings={dataElement:t},$.extend(!0,this.settings,o,e),this.settings.hide&&$(this.settings.dataElement).hide(),this.viewer=new n(this.settings)};r.prototype.getMap=function(){return this.viewer.getMap()},t.exports=r},function(t,e,i){var o=i(11),n=i(24),r=i(25),s=i(26),a=i(30),l=i(31),c=i(32),h=i(33),u=i(34),p=i(35),d=function(t){this.settings={dataProjection:"EPSG:4326",mapProjection:"EPSG:3857"},$.extend(this.settings,t),this.map=this.createMap(this.settings),this.layers=this.createLayersFromTileLayersConfig(this.settings.tileLayers),this.addLayersToMap(this.layers),this.geometryLayer=this.initGeometriesLayer(),this.settings.geometryType&&u(this.settings.geometryType)&&(this.showGeometryControl=this.initShowGeometryControl()),this.settings.tileLayerSwitcher&&this.initTileLayerSwitcher(this.settings),this.settings.editable&&(this.drawToolsControls=this.initDrawToolsControl({layer:this.geometryLayer,geometryType:this.settings.geometryType,translations:this.settings.translations})),this.settings.allowCapture&&this.initExportToPngControl()};d.prototype.getMap=function(){return this.map},d.prototype.createMap=function(t){t=t||{};var e="map-"+a(),i=$('<div id="'+e+'"></div>');return i.addClass("map"),i.css("width",t.width),i.css("height",t.height),i.insertAfter(t.dataElement),new ol.Map({target:e,view:new ol.View({center:ol.proj.transform([t.lon,t.lat],this.settings.dataProjection,this.settings.mapProjection),zoom:t.zoom,minZoom:t.minZoom,maxZoom:t.maxZoom,projection:this.settings.mapProjection}),controls:[new ol.control.Zoom,new ol.control.Attribution({collapsible:!1})]})},d.prototype.initGeometriesLayer=function(){var t=new ol.Collection,e=this.createVectorLayer(t);return this.getMap().addLayer(e),e},d.prototype.initShowGeometryControl=function(){var t=new s({geometryType:this.settings.geometryType,layer:this.geometryLayer,targetElement:this.settings.dataElement,hide:this.settings.hide,dataProjection:this.settings.dataProjection,precision:this.settings.precision});return t.on("set:geometries",function(t){this.settings.centerOnResults&&h(this.getMap(),this.geometryLayer.getSource().getFeaturesCollection()),this.getMap().dispatchEvent($.extend(t,{type:"change:geometries"}))}.bind(this)),t.on("error",function(t){this.getMap().dispatchEvent({type:"change:geometries",geojson:"{}",geometries:[]}),console.log(t.message)}),this.getMap().addControl(t),t},d.prototype.initTileLayerSwitcher=function(t){var e=this.createTileLayerSwitcher(this.layers,t);return this.getMap().addControl(e),e.setFondCartoByTilePosition(t.defaultSwitchableTile),e},d.prototype.initExportToPngControl=function(){var t=new r;this.getMap().addControl(t)},d.prototype.initDrawToolsControl=function(t){var e=new o({layer:t.layer,type:t.geometryType,multiple:!l(t.geometryType),translations:t.translations,precision:this.settings.precision,dataProjection:this.settings.dataProjection});return this.getMap().addControl(e),e.on("draw:change",function(t){this.settings.centerOnResults&&"draw:removed"!==t.originType&&h(this.getMap(),this.geometryLayer.getSource().getFeaturesCollection()),this.getMap().dispatchEvent($.extend(t,{type:"change:geometries"})),this.settings.geometryType&&u(this.settings.geometryType)&&this.showGeometryControl.setRawData(t.geojson)}.bind(this)),e},d.prototype.addLayersToMap=function(t){for(var e in t)null!==t[e]&&this.getMap().addLayer(t[e])},d.prototype.createVectorLayer=function(t){return new ol.layer.Vector({source:new ol.source.Vector({features:t}),style:c})},d.prototype.createLayersFromTileLayersConfig=function(t){var e=function(t){var e=t.url,i=t.title,o={minResolution:t.minResolution,maxResolution:t.maxResolution,opacity:t.opacity,attributions:[t.attribution],minZoom:t.minZoom,maxZoom:t.maxZoom,projection:t.projection,opaque:t.opaque,cacheSize:t.cacheSize,transition:t.transition,wrapX:t.wrapX};return new p(e,i,o)},i=[];for(var o in t){var n=e(t[o]);i[n.getTitle()]=n.getLayer()}return i},d.prototype.createTileLayerSwitcher=function(t,e){var i=new n({tileCoord:e.tileCoordinates}),o=e.switchableLayers;if(null===o||0===o.length)for(var r in t)null===t[r]?i.addTile([],r):i.addTile([t[r]],r);else for(var s in o)if(Array.isArray(o[s])){var a=o[s].join(" & "),l=[];for(var c in o[s])null!==t[o[s][c]]&&l.push(t[o[s][c]]);i.addTile(l,a)}else null===t[o[s]]?i.addTile([],o[s]):i.addTile([t[o[s]]],o[s]);return i.on("change:tile",function(t){this.getMap().dispatchEvent({type:"change:tile",tile:t.tile})}.bind(this)),i},t.exports=d},function(t,e,i){var o=i(12),n=i(13),r=i(14),s=(i(17),i(18)),a=i(20),l=i(3),c=i(4),h=i(6),u=function(t){this.translations=$.extend(o,t.translations||{}),this.layer=t.layer,this.featuresCollection=this.layer.getSource().getFeaturesCollection(),this.type=t.type||"Geometry",this.multiple=t.multiple||!1,this.style=t.style,this.dataProjection=t.dataProjection,this.precision=t.precision,this.controls=[];var e=$("<div>").addClass("ol-draw-tools ol-unselectable ol-control");ol.control.Control.call(this,{element:e.get(0),target:t.target})};ol.inherits(u,ol.control.Control),u.prototype.setMap=function(t){ol.control.Control.prototype.setMap.call(this,t),this.initControl()},u.prototype.initControl=function(){this.addDrawControls(),this.addEditControl(),this.addRemoveControl();var t=function(t){var e=c(this.layer.getSource().getFeaturesCollection(),{precision:this.precision,dataProjection:this.dataProjection,mapProjection:this.getMap().getView().getProjection()}),i="",o=null;e&&(i=l(e,this.type),o=h(e)),this.dispatchEvent({type:"draw:change",originType:t.type,geometries:o,geojson:i})}.bind(this);this.on("draw:added",t),this.on("draw:edited",t),this.on("draw:removed",t)},u.prototype.addDrawControls=function(){"Geometry"===this.type?(this.addDrawControl({type:"MultiPoint",multiple:!0,title:this.translations.draw.multipoint}),this.addDrawControl({type:"MultiLineString",multiple:!0,title:this.translations.draw.multilinestring}),this.addDrawControl({type:"MultiPolygon",multiple:!0,title:this.translations.draw.multipolygon})):this.addDrawControl({type:this.type,multiple:this.multiple,title:this.translations.draw[this.type.toLowerCase()]})},u.prototype.addDrawControl=function(t){t=t||{};var e=new n({featuresCollection:this.featuresCollection,type:t.type,target:this.element,style:function(e,i){return a(e,i,t.type)},multiple:t.multiple,title:t.title});e.on("draw:active",function(){this.deactivateControls(e),this.dispatchEvent("tool:active")}.bind(this)),this.getMap().addControl(e),e.getInteraction().on("drawend",function(t){e.isActive()&&setTimeout(function(){this.dispatchEvent({type:"draw:added"})}.bind(this),0)}.bind(this)),this.controls.push(e)},u.prototype.addEditControl=function(){var t=new r({layer:this.layer,target:this.element,title:this.translations.edit[this.type.toLowerCase()]});t.on("edit:active",function(){this.deactivateControls(t),this.dispatchEvent("tool:active")}.bind(this)),this.getMap().addControl(t);var e=function(){setTimeout(function(){this.dispatchEvent({type:"draw:edited"})}.bind(this),0)}.bind(this);t.getInteractions().forEach(function(t){t.on("modifyend",e),t.on("translateend",e)}.bind(this)),this.controls.push(t)},u.prototype.addRemoveControl=function(){var t=new s({featuresCollection:this.featuresCollection,target:this.element,title:this.translations.remove[this.type.toLowerCase()]});t.on("remove:active",function(){this.deactivateControls(t),this.dispatchEvent("tool:active")}.bind(this)),this.getMap().addControl(t),t.getInteraction().on("deleteend",function(){this.dispatchEvent({type:"draw:removed"}),setTimeout(function(){this.dispatchEvent({type:"draw:removed"})}.bind(this),0)}.bind(this)),this.controls.push(t)},u.prototype.deactivateControls=function(t){this.controls.forEach(function(e){e!==t&&e.setActive(!1)})},u.prototype.getControls=function(){return this.controls},t.exports=u},function(t){t.exports={draw:{point:"Ajouter un point",multipoint:"Ajouter un ou plusieurs points",linestring:"Dessiner un chemin",multilinestring:"Ajouter un ou plusieurs chemins",polygon:"Dessiner un polygone",multipolygon:"Dessiner un ou plusieurs polygones",rectangle:"Dessiner une emprise"},edit:{point:"Modifier un point",multipoint:"Modifier un point",linestring:"Modifier un chemin",multilinestring:"Modifier un chemin",polygon:"Modifier un polygone",multipolygon:"Modifier un polygone",rectangle:"Modifier une emprise",geometry:"Modifier une géométrie"},translate:{point:"Déplacer un point",multipoint:"Déplacer un point",linestring:"Déplacer un chemin",multilinestring:"Déplacer un chemin",polygon:"Déplacer un polygone",multipolygon:"Déplacer un polygone",rectangle:"Déplacer une emprise",geometry:"Déplacer une géométrie"},remove:{point:"Supprimer un point",multipoint:"Supprimer un point",linestring:"Supprimer un chemin",multilinestring:"Supprimer un chemin",polygon:"Supprimer un polygone",multipolygon:"Supprimer un polygone",rectangle:"Supprimer une emprise",geometry:"Supprimer une géométrie"}}},function(t,e){var i=function(t){this.featuresCollection=t.featuresCollection,this.type=t.type||"Point",this.style=t.style,this.multiple=t.multiple,this.title=t.title||"Draw a "+this.type.toLowerCase(),this.eventBaseName=t.eventBaseName||"draw";var e=$("<div>").addClass("ol-draw-"+this.type.toLowerCase()+" ol-unselectable ol-control");$("<button>").attr("title",this.title).on("touchstart click",function(t){t&&t.preventDefault&&t.preventDefault(),this.setActive(!this.active)}.bind(this)).appendTo(e),ol.control.Control.call(this,{element:e.get(0),target:t.target})};ol.inherits(i,ol.control.Control),i.prototype.setMap=function(t){ol.control.Control.prototype.setMap.call(this,t),this.initControl()},i.prototype.initControl=function(){this.addInteraction(),this.active=!1,this.setActive(this.active)},i.prototype.getActive=function(){return this.active},i.prototype.setActive=function(t){this.getInteraction().setActive(t),t&&!this.getActive()&&(this.dispatchEvent(this.eventBaseName+":active"),$(this.element).addClass("active"),this.active=!0),!t&&this.getActive()&&(this.dispatchEvent(this.eventBaseName+"inactive"),$(this.element).removeClass("active"),this.active=!1)},i.prototype.isActive=function(){return this.active},i.prototype.addInteraction=function(){var t={type:this.type,style:this.style,features:this.featuresCollection};"Square"===this.type&&(t.type="Circle",t.geometryFunction=ol.interaction.Draw.createRegularPolygon(4)),"Rectangle"===this.type&&(t.type="Circle",t.geometryFunction=ol.interaction.Draw.createBox());var e=new ol.interaction.Draw(t);e.on("drawend",function(t){this.multiple||this.featuresCollection.clear(),t.feature.set("type",this.type)}.bind(this)),this.getInteraction=function(){return e},this.getMap().addInteraction(e)},t.exports=i},function(t,e,i){var o=i(15),n=i(16),r=function(t){this.layer=t.layer,this.featuresCollection=this.layer.getSource().getFeaturesCollection(),this.title=t.title||"Edit a feature";var e=$("<div>").addClass("ol-edit ol-unselectable ol-control");$("<button>").attr("title",this.title).on("touchstart click",function(t){t&&t.preventDefault&&t.preventDefault(),this.setActive(!this.active)}.bind(this)).appendTo(e),ol.control.Control.call(this,{element:e.get(0),target:t.target})};ol.inherits(r,ol.control.Control),r.prototype.setMap=function(t){ol.control.Control.prototype.setMap.call(this,t),this.initControl()},r.prototype.initControl=function(){this.addInteractions(),this.active=!1,this.setActive(this.active)},r.prototype.getActive=function(){return this.active},r.prototype.setActive=function(t){this.getInteractions().forEach(function(e){e.setActive(t)}),t&&!this.getActive()&&(this.dispatchEvent("edit:active"),$(this.element).addClass("active"),this.active=!0),!t&&this.getActive()&&(this.dispatchEvent("edit:inactive"),$(this.element).removeClass("active"),this.active=!1)},r.prototype.addInteractions=function(){this.reorganiseFeaturesCollectionByType();var t=new ol.interaction.Modify({features:this.getFeaturesCollectionBasic(),hitTolerance:10}),e=new o({features:this.getFeaturesCollectionBox()}),i=new n({features:this.getFeaturesCollectionSquare()}),r=new ol.interaction.Translate({layers:[this.layer],hitTolerance:0});this.getInteractions=function(){return[t,e,i,r]},this.getInteractions().forEach(function(t){this.getMap().addInteraction(t)}.bind(this)),r.on("translatestart",function(){t.setActive(!1),i.setActive(!1),e.setActive(!1)}),r.on("translateend",function(){t.setActive(!0),i.setActive(!0),e.setActive(!0)})},r.prototype.reorganiseFeaturesCollectionByType=function(){var t=new ol.Collection;this.getFeaturesCollectionBasic=function(){return t};var e=new ol.Collection;this.getFeaturesCollectionBox=function(){return e};var i=new ol.Collection;this.getFeaturesCollectionSquare=function(){return i};var o=function(o){switch(o.get("type")){case"Rectangle":e.push(o);break;case"Square":i.push(o);break;default:t.push(o)}};this.featuresCollection.forEach(o),this.featuresCollection.on("add",function(t){o(t.element)}),this.featuresCollection.on("remove",function(o){!function(o){switch(o.get("type")){case"Rectangle":e.remove(o);break;case"Square":i.remove(o);break;default:t.remove(o)}}(o.element)})},t.exports=r},function(t,e){var i=function(t){t=$.extend({features:null},t),this.features=t.features,this.coordinate_=null,this.grabCursor_="grab",this.grabbingCursor_="grabbing",this.feature_=null,this.previousCursor_=void 0;var e=new ol.style.Fill({color:[0,153,255,1]}),o=new ol.style.Stroke({color:[255,255,255,1],width:1.5}),n=new ol.style.Circle({fill:e,stroke:o,radius:6}),r=new ol.style.Style({image:n,fill:e,stroke:o});this.overlay_=new ol.layer.Vector({source:new ol.source.Vector({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style||r,updateWhileAnimating:!0,updateWhileInteracting:!0}),this.overlayPoints_=[],ol.interaction.Pointer.call(this,{handleDownEvent:i.prototype.handleDownEvent,handleDragEvent:i.prototype.handleDragEvent,handleMoveEvent:i.prototype.handleMoveEvent,handleUpEvent:i.prototype.handleUpEvent})};ol.inherits(i,ol.interaction.Pointer),i.prototype.handleDownEvent=function(t){this.deltaX=0,this.deltaY=0;var e=this.getFeatureUnderMouse_(t);if(e){this.coordinate_=t.coordinate,this.feature_=e;var i=t.map.getTargetElement();i.style.cursor!==this.grabbingCursor_&&(i.style.cursor=this.grabbingCursor_)}return!!e},i.prototype.handleDragEvent=function(t){var e=this.getFeature_(t);this.deltaX=t.coordinate[0]-this.coordinate_[0],this.deltaY=t.coordinate[1]-this.coordinate_[1],e.getGeometry().translate(this.deltaX,this.deltaY),t.map.getTargetElement().style.cursor=this.grabbingCursor_,this.handleModify_(t),this.coordinate_[0]=t.coordinate[0],this.coordinate_[1]=t.coordinate[1]},i.prototype.handleMoveEvent=function(t){var e=this.getFeatureUnderMouse_(t),i=t.map.getTargetElement();e?i.style.cursor!==this.grabCursor_&&(this.previousCursor_=i.style.cursor,i.style.cursor=this.grabCursor_):void 0!==this.previousCursor_&&(i.style.cursor=this.previousCursor_,this.previousCursor_=void 0)},i.prototype.handleUpEvent=function(t){this.deltaX=0,this.deltaY=0;var e=t.map.getTargetElement();return this.feature_?e.style.cursor=this.grabCursor_:e.style.cursor=void 0,this.dispatchEvent({type:"modifyend",feature:this.feature_}),this.coordinate_=null,this.feature_=null,!1},i.prototype.handleModify_=function(t){var e=this.getFeatureOfModifyPoint_(this.feature_);e?this.setFeatureByModifyPoints_(e):this.moveModifyPointsWithFeature_()},i.prototype.setActive=function(t){ol.interaction.Pointer.prototype.setActive.call(this,t),t?this.enableModificationPoints(this.features):this.disableModificationPoints(this.features)},i.prototype.enableModificationPoints=function(t){null!==this.getMap()&&this.getMap().addLayer(this.overlay_),this.overlayPoints_=[],t.forEach(function(t){this.addModificationPoints_(t)}.bind(this))},i.prototype.disableModificationPoints=function(t){this.removeModificationPoints_(t)},i.prototype.removeModificationPoints_=function(t){for(var e in this.overlayPoints_)for(var i in this.overlayPoints_[e].modificationPoints)t.remove(this.overlayPoints_[e].modificationPoints[i]);this.overlay_.getSource().clear(),null!==this.getMap()&&this.getMap().removeLayer(this.overlay_),this.overlayPoints_=[]},i.prototype.addModificationPoints_=function(t){var e=t.getGeometry().getCoordinates()[0],i=[];for(var o in e)if("4"!==o){var n=new ol.Feature({geometry:new ol.geom.Point(e[o])});this.overlay_.getSource().addFeature(n),i[o]=n,this.features.push(n)}else i[o]=i[0];this.overlayPoints_.push({feature:t,modificationPoints:i})},i.prototype.getFeatureUnderMouse_=function(t){return t.map.forEachFeatureAtPixel(t.pixel,function(t){for(var e in this.features.getArray())if(this.features.getArray()[e]===t)return t}.bind(this))},i.prototype.getFeature_=function(t){return this.feature_},i.prototype.setFeatureByModifyPoints_=function(t){var e=this.getModifyPointsOfFeature_(t);this.updateLinkedModifyPointForBBox(this.feature_,e),this.redrawFeatureByModificationPointsPosition(t,e)},i.prototype.updateLinkedModifyPointForBBox=function(t,e){var i;for(var o in e)if(t===e[o]){i=parseInt(o);break}var n=i-1,r=i+1;0===i&&(n=3),3===i&&(r=0),i%2!=0?(e[n].getGeometry().translate(0,this.deltaY),e[r].getGeometry().translate(this.deltaX,0)):(e[n].getGeometry().translate(this.deltaX,0),e[r].getGeometry().translate(0,this.deltaY)),e[4].getGeometry().setCoordinates(e[0].getGeometry().getCoordinates())},i.prototype.redrawFeatureByModificationPointsPosition=function(t,e){var i=[];for(var o in e)i.push(e[o].getGeometry().getCoordinates());t.getGeometry().setCoordinates([i])},i.prototype.moveModifyPointsWithFeature_=function(){var t,e=this.getModifyPointsOfFeature_(this.feature_);switch(this.feature_.getGeometry().getType()){case"Polygon":(t=this.feature_.getGeometry().getCoordinates()[0]).pop()}for(var i in t)e[i].getGeometry().setCoordinates(t[i])},i.prototype.getFeatureOfModifyPoint_=function(t){for(var e in this.overlayPoints_)for(var i in this.overlayPoints_[e].modificationPoints)if(this.overlayPoints_[e].modificationPoints[i]===t)return this.overlayPoints_[e].feature},i.prototype.getModifyPointsOfFeature_=function(t){for(var e in this.overlayPoints_)if(this.overlayPoints_[e].feature===t)return this.overlayPoints_[e].modificationPoints},t.exports=i},function(t,e){var i=function(t){t=$.extend({features:null},t),this.features=t.features,this.coordinate_=null,this.grabCursor_="grab",this.grabbingCursor_="grabbing",this.feature_=null,this.previousCursor_=void 0,this.overlay_=new ol.layer.Vector({source:new ol.source.Vector({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style,updateWhileAnimating:!0,updateWhileInteracting:!0}),this.overlayPoints_=[],ol.interaction.Pointer.call(this,{handleDownEvent:i.prototype.handleDownEvent,handleDragEvent:i.prototype.handleDragEvent,handleMoveEvent:i.prototype.handleMoveEvent,handleUpEvent:i.prototype.handleUpEvent})};ol.inherits(i,ol.interaction.Pointer),i.prototype.handleDownEvent=function(t){this.deltaX=0,this.deltaY=0;var e=this.getFeatureUnderMouse_(t);if(e){this.coordinate_=t.coordinate,this.feature_=e;var i=t.map.getTargetElement();i.style.cursor!==this.grabbingCursor_&&(i.style.cursor=this.grabbingCursor_)}return!!e},i.prototype.handleDragEvent=function(t){var e=this.getFeature_(t);this.deltaX=t.coordinate[0]-this.coordinate_[0],this.deltaY=t.coordinate[1]-this.coordinate_[1],e.getGeometry().translate(this.deltaX,this.deltaY),t.map.getTargetElement().style.cursor=this.grabbingCursor_,this.handleModify_(t),this.coordinate_[0]=t.coordinate[0],this.coordinate_[1]=t.coordinate[1]},i.prototype.handleMoveEvent=function(t){var e=this.getFeatureUnderMouse_(t),i=t.map.getTargetElement();e?i.style.cursor!==this.grabCursor_&&(this.previousCursor_=i.style.cursor,i.style.cursor=this.grabCursor_):void 0!==this.previousCursor_&&(i.style.cursor=this.previousCursor_,this.previousCursor_=void 0)},i.prototype.handleUpEvent=function(t){this.deltaX=0,this.deltaY=0;var e=t.map.getTargetElement();return this.feature_?e.style.cursor=this.grabCursor_:e.style.cursor=void 0,this.dispatchEvent({type:"modifyend",feature:this.feature_}),this.coordinate_=null,this.feature_=null,!1},i.prototype.handleModify_=function(t){var e=this.getFeatureOfModifyPoint_(this.feature_);e?this.setFeatureByModifyPoints_(e):this.moveModifyPointsWithFeature_()},i.prototype.setActive=function(t){ol.interaction.Pointer.prototype.setActive.call(this,t),t?this.enableModificationPoints(this.features):this.disableModificationPoints(this.features)},i.prototype.enableModificationPoints=function(t){null!==this.getMap()&&this.getMap().addLayer(this.overlay_),this.overlayPoints_=[],t.forEach(function(t){this.addModificationPoints_(t)}.bind(this))},i.prototype.disableModificationPoints=function(t){this.removeModificationPoints_(t)},i.prototype.removeModificationPoints_=function(t){for(var e in this.overlayPoints_)for(var i in this.overlayPoints_[e].modificationPoints)t.remove(this.overlayPoints_[e].modificationPoints[i]);this.overlay_.getSource().clear(),null!==this.getMap()&&this.getMap().removeLayer(this.overlay_),this.overlayPoints_=[]},i.prototype.addModificationPoints_=function(t){var e=t.getGeometry().getCoordinates()[0],i=[];for(var o in e)if("4"!==o){var n=new ol.Feature({geometry:new ol.geom.Point(e[o])});this.overlay_.getSource().addFeature(n),i[o]=n,this.features.push(n)}else i[o]=i[0];this.overlayPoints_.push({feature:t,modificationPoints:i})},i.prototype.getFeatureUnderMouse_=function(t){return t.map.forEachFeatureAtPixel(t.pixel,function(t){for(var e in this.features.getArray())if(this.features.getArray()[e]===t)return t}.bind(this))},i.prototype.getFeature_=function(t){return this.feature_},i.prototype.setFeatureByModifyPoints_=function(t){var e=this.getModifyPointsOfFeature_(t);this.updateLinkedModifyPointForBBox(this.feature_,e),this.redrawFeatureByModificationPointsPosition(t,e)},i.prototype.updateLinkedModifyPointForBBox=function(t,e){var i;for(var o in e)if(t===e[o]){i=parseInt(o);break}var n=i-1,r=i+1;0===i&&(n=3),3===i&&(r=0),i%2!=0?(e[n].getGeometry().translate(0,this.deltaY),e[r].getGeometry().translate(this.deltaX,0)):(e[n].getGeometry().translate(this.deltaX,0),e[r].getGeometry().translate(0,this.deltaY)),e[4].getGeometry().setCoordinates(e[0].getGeometry().getCoordinates())},i.prototype.redrawFeatureByModificationPointsPosition=function(t,e){var i=[];for(var o in e)i.push(e[o].getGeometry().getCoordinates());t.getGeometry().setCoordinates([i])},i.prototype.moveModifyPointsWithFeature_=function(){var t,e=this.getModifyPointsOfFeature_(this.feature_);switch(this.feature_.getGeometry().getType()){case"Polygon":(t=this.feature_.getGeometry().getCoordinates()[0]).pop()}for(var i in t)e[i].getGeometry().setCoordinates(t[i])},i.prototype.getFeatureOfModifyPoint_=function(t){for(var e in this.overlayPoints_)for(var i in this.overlayPoints_[e].modificationPoints)if(this.overlayPoints_[e].modificationPoints[i]===t)return this.overlayPoints_[e].feature},i.prototype.getModifyPointsOfFeature_=function(t){for(var e in this.overlayPoints_)if(this.overlayPoints_[e].feature===t)return this.overlayPoints_[e].modificationPoints},t.exports=i},function(t,e){var i=function(t){this.title=t.title||"Move a geometry",this.featuresCollection=t.featuresCollection;var e=$("<div>").addClass("ol-translate ol-unselectable ol-control");$("<button>").attr("title",this.title).on("touchstart click",function(t){t&&t.preventDefault&&t.preventDefault(),this.setActive(!this.active)}.bind(this)).appendTo(e),ol.control.Control.call(this,{element:e.get(0),target:t.target})};ol.inherits(i,ol.control.Control),i.prototype.setMap=function(t){ol.control.Control.prototype.setMap.call(this,t),this.initControl()},i.prototype.initControl=function(){this.addTranslateInteraction(),this.active=!1,this.setActive(this.active)},i.prototype.getActive=function(){return this.active},i.prototype.setActive=function(t){this.getInteraction().setActive(t),t&&!this.getActive()&&(this.dispatchEvent("translate:active"),$(this.element).addClass("active"),this.active=!0),!t&&this.getActive()&&(this.dispatchEvent("translate:inactive"),$(this.element).removeClass("active"),this.active=!1)},i.prototype.addTranslateInteraction=function(){var t=new ol.interaction.Translate({features:this.featuresCollection,hitTolerance:10});t.on("translateend",function(t){this.getMap().dispatchEvent($.extend(t,{type:"draw:edited"}))}.bind(this)),this.getMap().addInteraction(t),this.getInteraction=function(){return t}},t.exports=i},function(t,e,i){var o=i(19),n=function(t){this.featuresCollection=t.featuresCollection,this.title=t.title||"Remove a geometry";var e=$("<div>").addClass("ol-delete ol-unselectable ol-control");$("<button>").attr("title",this.title).on("touchstart click",function(t){t&&t.preventDefault&&t.preventDefault(),this.setActive(!this.active)}.bind(this)).appendTo(e),ol.control.Control.call(this,{element:e.get(0),target:t.target})};ol.inherits(n,ol.control.Control),n.prototype.setMap=function(t){ol.control.Control.prototype.setMap.call(this,t),this.initControl()},n.prototype.initControl=function(){this.addInteraction(),this.active=!1,this.setActive(this.active)},n.prototype.getActive=function(){return this.active},n.prototype.setActive=function(t){this.getInteraction().setActive(t),t&&!this.getActive()&&(this.dispatchEvent("remove:active"),$(this.element).addClass("active"),this.active=!0),!t&&this.getActive()&&(this.dispatchEvent("remove:inactive"),$(this.element).removeClass("active"),this.active=!1)},n.prototype.addInteraction=function(){var t=new o({features:this.featuresCollection});this.getInteraction=function(){return t},this.getMap().addInteraction(t)},t.exports=n},function(t,e){var i=function(t){t=$.extend({features:null},t),ol.interaction.Pointer.call(this,{handleDownEvent:i.prototype.handleDownEvent,handleDragEvent:i.prototype.handleDragEvent,handleMoveEvent:i.prototype.handleMoveEvent,handleUpEvent:i.prototype.handleUpEvent}),this.features=t.features,this.pointerCursor_="pointer",this.feature_=null,this.previousCursor_=void 0};ol.inherits(i,ol.interaction.Pointer),i.prototype.handleDownEvent=function(t){var e=t.map.forEachFeatureAtPixel(t.pixel,function(t){for(var e in this.features.getArray())if(this.features.getArray()[e]===t)return t}.bind(this));return this.feature_=e,!!e},i.prototype.handleDragEvent=function(t){var e=t.map.forEachFeatureAtPixel(t.pixel,function(t){for(var e in this.features.getArray())if(this.features.getArray()[e]===t)return t}.bind(this)),i=t.map.getTargetElement();e?i.style.cursor!=this.pointerCursor_&&(this.previousCursor_=i.style.cursor,i.style.cursor=this.pointerCursor_):void 0!==this.previousCursor_&&(i.style.cursor=this.previousCursor_,this.previousCursor_=void 0)},i.prototype.handleMoveEvent=function(t){var e=t.map.forEachFeatureAtPixel(t.pixel,function(t){for(var e in this.features.getArray())if(this.features.getArray()[e]===t)return t}.bind(this)),i=t.map.getTargetElement();e?i.style.cursor!=this.pointerCursor_&&(this.previousCursor_=i.style.cursor,i.style.cursor=this.pointerCursor_):void 0!==this.previousCursor_&&(i.style.cursor=this.previousCursor_,this.previousCursor_=void 0)},i.prototype.handleUpEvent=function(t){var e=t.map,i=(e.forEachFeatureAtPixel(t.pixel,function(t){for(var e in this.features.getArray())this.features.getArray()[e]===t&&this.feature_===t&&this.features.remove(t)}.bind(this)),e.forEachFeatureAtPixel(t.pixel,function(t){for(var e in this.features.getArray())if(this.features.getArray()[e]===t)return t}.bind(this))),o=t.map.getTargetElement();return i?o.style.cursor=this.pointerCursor_:void 0!==o.style.cursor&&(o.style.cursor=void 0),this.dispatchEvent({type:"deleteend"}),!1},t.exports=i},function(t,e,i){var o=i(1),n=i(2),r=i(51);t.exports=function(t,e,i){switch(i){case"Point":case"MultiPoint":var s=new ol.style.Style({image:new ol.style.Icon({anchor:[.5,41],anchorXUnits:"fraction",anchorYUnits:"pixels",opacity:1,src:n})});return[new ol.style.Style({image:new ol.style.Icon({anchor:[14,41],anchorXUnits:"pixels",anchorYUnits:"pixels",opacity:1,src:o})}),s]}return r()}},function(t,e,i){var o=i(22).coordEach;t.exports=function(t){var e=[1/0,1/0,-1/0,-1/0];return o(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}},function(t,e){function i(t,e,i){var o,n,r,s,a,c,h,u,p,d=0,y="FeatureCollection"===t.type,f="Feature"===t.type,g=y?t.features.length:1;for(o=0;o<g;o++)for(c=(p="GeometryCollection"===(u=y?t.features[o].geometry:f?t.geometry:t).type)?u.geometries.length:1,s=0;s<c;s++)if(h=(a=p?u.geometries[s]:u).coordinates,d=!i||"Polygon"!==a.type&&"MultiPolygon"!==a.type?0:1,"Point"===a.type)e(h);else if("LineString"===a.type||"MultiPoint"===a.type)for(n=0;n<h.length;n++)e(h[n]);else if("Polygon"===a.type||"MultiLineString"===a.type)for(n=0;n<h.length;n++)for(r=0;r<h[n].length-d;r++)e(h[n][r]);else{if("MultiPolygon"!==a.type)throw new Error("Unknown Geometry Type");for(n=0;n<h.length;n++)for(r=0;r<h[n].length;r++)for(l=0;l<h[n][r].length-d;l++)e(h[n][r][l])}}function o(t,e){var i;switch(t.type){case"FeatureCollection":for(features=t.features,i=0;i<t.features.length;i++)e(t.features[i].properties);break;case"Feature":e(t.properties)}}t.exports.coordEach=i,t.exports.coordReduce=function(t,e,o,n){return i(t,function(t){o=e(o,t)},n),o},t.exports.propEach=o,t.exports.propReduce=function(t,e,i){return o(t,function(t){i=e(i,t)}),i}},function(t,e){t.exports=function(t){var e={};for(var i in t.forEach(function(t){e[t.type]||(e[t.type]=[]),e[t.type].push(t)}),e)if(i.includes("Multi")){var o=[];e[i].forEach(function(t){o.push(t.coordinates[0])});var n={type:i,coordinates:o};e[i]=[n]}if(Object.keys(e).length>1){var r=[];for(var i in e)for(var s in e[i])r.push(e[i][s]);return{type:"GeometryCollection",geometries:r}}for(var i in e){if(e[i].length>1){for(var s in r=[],e[i])r.push(e[i][s]);return{type:"GeometryCollection",geometries:r}}return e[i][0]}}},function(t,e){var i=function(t){this.settings=$.extend({tileCoord:[9,253,-177],defaultTileImgUrl:null},t);var e=$("<div>").addClass("ol-tile-layer-switcher ol-unselectable ol-control");ol.control.Control.call(this,{element:e.get(0),target:t.target}),this.tilesToAddWhenSetMap=[]};ol.inherits(i,ol.control.Control),i.prototype.setMap=function(t){ol.control.Control.prototype.setMap.call(this,t),this.initControl()},i.prototype.initControl=function(){this.tiles={},this.addTiles(this.tilesToAddWhenSetMap),this.tilesToAddWhenSetMap=[]},i.prototype.createTile=function(t,e){return new o(this,t,e)},i.prototype.addTile=function(t,e){var i=this.createTile(t,e);if(this.getMap()){for(i.createElement();this.isTileExist(i.id);)i.changeId(i.id+"_");this.tiles[i.id]=i,i.element.appendTo(this.element),i.position=Object.keys(this.tiles).length,i.element.css({"z-index":99-(Object.keys(this.tiles).length+1)});var o=this;i.element.on("touchstart click",function(){o.setFondCarto(i.id)})}else this.tilesToAddWhenSetMap.push(i);return i},i.prototype.addTiles=function(t){for(var e in t)this.addTile(t[e].layers,t[e].title)},i.prototype.deploy=function(t){t?$(this.element).addClass("deployed"):$(this.element).removeClass("deployed")},i.prototype.setFondCarto=function(t,e){this.deactivateAllTiles(),this.isTileExist(t)&&this.tiles[t].setActive(!0),!1!==e&&this.dispatchEvent({type:"change:tile",id:t,tile:this.tiles[t]})},i.prototype.setFondCartoByTilePosition=function(t,e){this.setFondCarto(this.getTileByPosition(t).getId(),e)},i.prototype.deactivateAllTiles=function(){for(var t in this.tiles)this.tiles[t].setActive(!1)},i.prototype.isTileExist=function(t){return void 0!==this.tiles[t]},i.prototype.getTiles=function(){return this.tiles},i.prototype.getTileById=function(t){return this.tiles[t]||null},i.prototype.getTileByPosition=function(t){for(var e in this.tiles)if(this.tiles[e].position===t)return this.tiles[e];return null},i.prototype.getLayerImageUrl=function(t){var e=t.getSource();return e.getTileUrlFunction?e.getTileUrlFunction()(this.settings.tileCoord,1,this.getMap().getView().getProjection()):null},t.exports=i;var o=function(t,e,i){this.tileLayerSwitcher=t,this.active=!1,this.title=i,this.layers=e,this.position=null,this.id="ol-tile-"+i.toLowerCase().replace(/[.& ]/gi,"_")};o.prototype.setActive=function(t){$(this.layers).each(function(){this.getVisible()!==t&&this.setVisible(t)}),this.active=t,t?this.element.addClass("active"):this.element.removeClass("active")},o.prototype.createElement=function(){this.element=$('<div class="ol-tile-item">');var t=$("<button>").attr("id",this.id).appendTo(this.element),e=($("<label>").html(this.title).appendTo(this.element),$('<div class="tile-images">').appendTo(t)),i=$("<img>");for(var o in this.layers)i.clone().attr("src",this.tileLayerSwitcher.getLayerImageUrl(this.layers[o])).attr("style","opacity : "+this.layers[o].getOpacity()+";").appendTo(e);return this.element},o.prototype.changeId=function(t){this.id=t,this.element.find("button").attr("id",t)},o.prototype.getPosition=function(){return this.position},o.prototype.getId=function(){return this.id}},function(t,e){var i=function(t){t||(t={});this.settings=$.extend({format:"png"},t);var e=$("<div>").addClass("ol-export-to-png ol-unselectable ol-control");$("<button>").attr("title","Exporter au format "+this.settings.format).on("touchstart click",function(t){t&&t.preventDefault&&t.preventDefault(),this.export()}.bind(this)).appendTo(e),this.$previewElement=$("<a>").attr("title","Prévisualiser").addClass("preview").html("").hide().appendTo(e),this.$downloadElement=$("<a>").attr("title","Télécharger").addClass("download").html("").hide().appendTo(e),this.$modalBackground=$("<div>").addClass("modal-container-export").hide(),this.$modalPreviewElement=$("<div>").addClass("modal-content-export").appendTo(this.$modalBackground),this.$modalTitle=$("<p>").addClass("title-modal-export").html("Prévisualisation").appendTo(this.$modalPreviewElement),this.$modalCloser=$("<span>").addClass("close-modal-export").attr("title","Fermer").html("&times;").appendTo(this.$modalPreviewElement).on("touchstart click",function(){this.$modalBackground.hide()}.bind(this)),this.$previewImage=$("<img>").addClass("image-preview").attr("alt","Prévisualisation de la capture de la carte").attr("title","Prévisualisation de la capture de la carte").appendTo(this.$modalPreviewElement),$divDownloadModal=$("<div>").addClass("modal-download-container").appendTo(this.$modalPreviewElement),this.$downloadModalElement=$("<a>").attr("title","Télécharger").addClass("download-modal").html("Télécharger").appendTo($divDownloadModal),ol.control.Control.call(this,{element:e.get(0),target:t.target})};ol.inherits(i,ol.control.Control),i.prototype.setMap=function(t){ol.control.Control.prototype.setMap.call(this,t),this.initControl()},i.prototype.initControl=function(){this.base64Image=null,this.$modalBackground.appendTo($(this.getMap().getViewport())),this.$previewElement.on("touchstart click",function(){this.$modalBackground.show()}.bind(this))},i.prototype.export=function(){var t=$(this.getMap().getViewport()).find("canvas").get(0).toDataURL(this.settings.format);this.base64Image!==t?(this.getMap().dispatchEvent({type:"export:image",src:t}),this.$previewElement.show(),this.$previewImage.attr("src",t),this.$downloadElement.attr("download","map-export."+this.settings.format).attr("href",t).show(),this.$downloadModalElement.attr("download","map-export."+this.settings.format).attr("href",t),this.base64Image=t):(this.$previewElement.toggle(),this.$downloadElement.toggle())},t.exports=i},function(t,e,i){var o=i(27),n=i(29),r=i(6),s=i(3),a=i(4),l=function(t){this.geometryType=t.geometryType,this.layer=t.layer,this.hide=t.hide,this.dataProjection=t.dataProjection,this.precision=t.precision,this.centerOnResults=t.centerOnResults,ol.control.Control.call(this,{element:t.targetElement})};ol.inherits(l,ol.control.Control),l.prototype.setMap=function(t){ol.control.Control.prototype.setMap.call(this,t),this.initControl()},l.prototype.initControl=function(){$(this.element).insertBefore(this.getMap().getTargetElement()),this.hide&&$(this.element).hide(),this.updateGeometriesOnMap(),$(this.element).on("change",function(t){this.updateGeometriesOnMap()}.bind(this))},l.prototype.updateGeometriesOnMap=function(){var t=this.getRawData();if(""!==t){try{var e=JSON.parse(t)}catch(t){return this.dispatchEvent({type:"error",message:"Invalid GeoJSON.",error:t}),void this.layer.getSource().clear()}if(e instanceof Array&&4===e.length&&(e=o(e).geometry),n(e)){var i=r(e);this.setGeometriesOnMap(i),this.dispatchEvent({type:"set:geometries",geometries:i,geojson:t})}}},l.prototype.setGeometriesOnMap=function(t){this.layer.getSource().clear();var e=new ol.format.GeoJSON;for(var i in t){var o=e.readGeometry(JSON.stringify(t[i])),n=new ol.Feature({geometry:o.transform(this.dataProjection,this.getMap().getView().getProjection())});n.set("type",this.geometryType),this.layer.getSource().getFeaturesCollection().push(n)}},l.prototype.updateGeometriesOnElement=function(){this.serializeGeometry()},l.prototype.serializeGeometry=function(){var t=a(this.layer.getSource().getFeaturesCollection(),{precision:this.precision,dataProjection:this.dataProjection,mapProjection:this.getMap().getView().getProjection()}),e="";t&&(e=s(t,this.geometryType)),this.setRawData(e)},l.prototype.getRawData=function(){return this.isDataElementAnInput()?$.trim($(this.element).val()):$.trim($(this.element).html())},l.prototype.setRawData=function(t){this.getRawData()!==t&&(this.isDataElementAnInput()?$(this.element).val(t):$(this.element).html(t))},l.prototype.isDataElementAnInput=function(){return void 0!==$(this.element).attr("value")},t.exports=l},function(t,e,i){var o=i(28);t.exports=function(t){var e=[t[0],t[1]],i=[t[0],t[3]],n=[t[2],t[3]],r=[t[2],t[1]];return o([[e,r,n,i,e]])}},function(t,e){t.exports=function(t,e){if(null===t)throw new Error("No coordinates passed");for(var i=0;i<t.length;i++)for(var o=t[i],n=0;n<o[o.length-1].length;n++){if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(o[o.length-1][n]!==o[0][n])throw new Error("First and last Position are not equivalent.")}var r={type:"Feature",geometry:{type:"Polygon",coordinates:t},properties:e};return r.properties||(r.properties={}),r}},function(t,e){t.exports=function(t){var e=function(t){if(!t.type)return!1;switch(t.type){case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":break;default:return!1}return!!t.coordinates&&0!=(new ol.format.GeoJSON).readGeometry(JSON.stringify(t)).getCoordinates().length};if(t.geometries){for(var i in t.geometries)if(!e(t.geometries[i]))return!1}else if(!e(t))return!1;return!0}},function(t,e){t.exports=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}},function(t,e){t.exports=function(t){return-1!==["Point","LineString","Polygon","Rectangle"].indexOf(t)}},function(t,e,i){var o=i(1),n=i(2),r=i(51);t.exports=function(t,e){switch(type=t.getGeometry().getType(),type){case"Point":case"MultiPoint":var i=new ol.style.Style({image:new ol.style.Icon({anchor:[.5,41],anchorXUnits:"fraction",anchorYUnits:"pixels",opacity:1,src:n})});return[new ol.style.Style({image:new ol.style.Icon({anchor:[14,41],anchorXUnits:"pixels",anchorYUnits:"pixels",opacity:1,src:o})}),i]}return r()}},function(t,e){t.exports=function(t,e){var i=[];e.forEach(function(t){i.push(t.getGeometry())}),0!==i.length&&t.getView().fit(new ol.geom.GeometryCollection(i).getExtent(),{size:t.getSize(),duration:100})}},function(t,e){t.exports=function(t){switch(t){case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"Geometry":case"Rectangle":return!0;default:return!1}}},function(t,e){var i=function(t,e,i){return this.settings={url:t,crossOrigin:"Anonymous"},$.extend(!0,this.settings,i),this.layer=null,t&&(this.layer=new ol.layer.Tile({source:new ol.source.XYZ(this.settings),minResolution:this.settings.minResolution,maxResolution:this.settings.maxResolution,opacity:this.settings.opacity})),this.url=t,this.title=e,this};i.prototype.getLayer=function(){return this.layer},i.prototype.getUrl=function(){return this.url},i.prototype.getTitle=function(){return this.title},t.exports=i},function(t,e){},,,,,,,,function(t,e){},,function(t,e){},,,,,function(t,e){t.exports=function(){var t=new ol.style.Fill({color:"rgba(255,255,255,0.4)"}),e=new ol.style.Stroke({color:"#3399CC",width:1.25}),i=new ol.style.Circle({fill:t,stroke:e,radius:5});return[new ol.style.Style({image:i,fill:t,stroke:e})]}}]);